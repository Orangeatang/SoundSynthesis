
//////////////////////////////////////////////////////////////////////////
/// Includes
//////////////////////////////////////////////////////////////////////////

#include "stdafx.h"
#include "AudioEffect.h"
#include "SoundSystem.h"


//////////////////////////////////////////////////////////////////////////
/// CAudioEffect
//////////////////////////////////////////////////////////////////////////

CAudioEffect::CAudioEffect( CSoundSystem* aSoundSystem, UINT32 someFlags, UINT32 aChannelCount, UINT32 aSampleRate ) : IAudioObject( aSoundSystem, someFlags ),
    myVoice( nullptr ),
    myChannelCount( aChannelCount ),
    mySampleRate( aSampleRate )
{
}

//////////////////////////////////////////////////////////////////////////

CAudioEffect::~CAudioEffect()
{
}

//////////////////////////////////////////////////////////////////////////

IXAudio2SubmixVoice* CAudioEffect::GetVoice() const
{
    return myVoice;
}

//////////////////////////////////////////////////////////////////////////

UINT32 CAudioEffect::GetChannelCount() const
{
    return myChannelCount;
}

//////////////////////////////////////////////////////////////////////////

void CAudioEffect::SetChannelCount( UINT32 aChannelCount )
{
    myChannelCount = aChannelCount;
}

//////////////////////////////////////////////////////////////////////////

UINT32 CAudioEffect::GetSampleRate() const
{
    return mySampleRate;
}

//////////////////////////////////////////////////////////////////////////

void CAudioEffect::SetSampleRate( UINT32 aSampleRate )
{
    mySampleRate = aSampleRate;
}

//////////////////////////////////////////////////////////////////////////

bool CAudioEffect::CreateVoice()
{
    IXAudio2* xaudio2 = mySoundSystem->GetInterface();
    assert( xaudio2 != nullptr );

    HRESULT result = xaudio2->CreateSubmixVoice( &myVoice, myChannelCount, mySampleRate, myVoiceFlags );
    assert( result == S_OK );

    return (result == S_OK);
}

//////////////////////////////////////////////////////////////////////////